# -*- coding: utf-8 -*-

import json


def calcInter(keshi, buwei):
    with open('../data/KeshiDisea.json', 'r', encoding='utf-8') as file:
        keshiData = json.load(file)


    with open('../data/classfify.json','r',encoding='utf-8') as cfile:
        buweiData = json.load(cfile)

    # 下面计算交集大小
    keshi_list = keshiData[keshi]
    print(len(keshi_list))
    buwei_list = buweiData[buwei]
    print(len(buwei_list))
    Inter_list = []
    if len(keshi_list) > len(buwei_list):
        for i in keshi_list:
            if i in buwei_list:
                Inter_list.append(i)
    else:
        for i in buwei_list:
            if i in keshi_list:
                Inter_list.append(i)

    print(len(Inter_list))
    return Inter_list

def cala():

    with open('../data/KeshiDisea.json', 'r', encoding='utf-8') as file:
        keshiData = json.load(file)


    with open('../data/classfify.json','r',encoding='utf-8') as cfile:
        buweiData = json.load(cfile)


    couple_list = []
    length_list = []
    for keshi in keshiData:
        for buwei in buweiData:  #


            print(keshi, len(keshiData[keshi]))
            print(buwei, len(buweiData[buwei]))
            # print()
            # print()

            Inter_list = calcInter(keshiData[keshi], buweiData[buwei])

            # print("交集为： ", Inter_list)

            if len(Inter_list) == 0:  # 如果没有交集，就没意思了
                continue
            print("交集大小为： ", len(Inter_list))

            couple_list.append((keshi, buwei))

            keshiRate = (len(keshiData[keshi]) - len(Inter_list)) / len(keshiData[keshi])

            print("比所在科室计算量减少了"+str(
                keshiRate
            )+"%")


            buweiRate = (len(buweiData[buwei]) - len(Inter_list)) / len(buweiData[buwei])
            print("比所在部位计算量减少了" + str(
                buweiRate
            ) + "%")
            length_list.append((keshiRate, buweiRate))
    print(couple_list)
    print(length_list)
    exit()
couple_list = [('内科', 'Head'), ('内科', 'Body'), ('内科', 'Other'), ('内科', 'Tail'), ('呼吸内科', 'Head'), ('呼吸内科', 'Body'), ('呼吸内科', 'Other'), ('呼吸内科', 'Tail'), ('儿科', 'Head'), ('儿科', 'Body'), ('儿科', 'Other'), ('儿科', 'Tail'), ('小儿内科', 'Head'), ('小儿内科', 'Body'), ('小儿内科', 'Other'), ('小儿内科', 'Tail'), ('急诊科', 'Head'), ('急诊科', 'Body'), ('急诊科', 'Other'), ('急诊科', 'Tail'), ('其他科室', 'Body'), ('其他科室', 'Other'), ('其他科室', 'Tail'), ('其他综合', 'Body'), ('其他综合', 'Other'), ('其他综合', 'Tail'), ('肿瘤科', 'Head'), ('肿瘤科', 'Body'), ('肿瘤科', 'Other'), ('肿瘤科', 'Tail'), ('肿瘤内科', 'Head'), ('肿瘤内科', 'Body'), ('肿瘤内科', 'Other'), ('肿瘤内科', 'Tail'), ('外科', 'Head'), ('外科', 'Body'), ('外科', 'Other'), ('外科', 'Tail'), ('心胸外科', 'Head'), ('心胸外科', 'Body'), ('心胸外科', 'Other'), ('心胸外科', 'Tail'), ('感染科', 'Head'), ('感染科', 'Body'), ('感染科', 'Other'), ('感染科', 'Tail'), ('传染科', 'Head'), ('传染科', 'Body'), ('传染科', 'Other'), ('传染科', 'Tail'), ('儿科综合', 'Head'), ('儿科综合', 'Body'), ('儿科综合', 'Other'), ('儿科综合', 'Tail'), ('妇产科', 'Head'), ('妇产科', 'Body'), ('妇产科', 'Other'), ('妇产科', 'Tail'), ('产科', 'Head'), ('产科', 'Body'), ('产科', 'Other'), ('产科', 'Tail'), ('普外科', 'Head'), ('普外科', 'Body'), ('普外科', 'Other'), ('普外科', 'Tail'), ('心内科', 'Head'), ('心内科', 'Body'), ('心内科', 'Other'), ('心内科', 'Tail'), ('肿瘤外科', 'Head'), ('肿瘤外科', 'Body'), ('肿瘤外科', 'Other'), ('肿瘤外科', 'Tail'), ('神经内科', 'Head'), ('神经内科', 'Body'), ('神经内科', 'Other'), ('神经内科', 'Tail'), ('风湿免疫科', 'Head'), ('风湿免疫科', 'Body'), ('风湿免疫科', 'Other'), ('风湿免疫科', 'Tail'), ('五官科', 'Head'), ('五官科', 'Body'), ('五官科', 'Other'), ('五官科', 'Tail'), ('眼科', 'Head'), ('眼科', 'Body'), ('眼科', 'Other'), ('眼科', 'Tail'), ('内分泌科', 'Head'), ('内分泌科', 'Body'), ('内分泌科', 'Other'), ('内分泌科', 'Tail'), ('小儿外科', 'Head'), ('小儿外科', 'Body'), ('小儿外科', 'Other'), ('小儿外科', 'Tail'), ('耳鼻喉科', 'Head'), ('耳鼻喉科', 'Body'), ('耳鼻喉科', 'Other'), ('耳鼻喉科', 'Tail'), ('妇科', 'Head'), ('妇科', 'Body'), ('妇科', 'Other'), ('妇科', 'Tail'), ('康复科', 'Body'), ('康复科', 'Other'), ('康复科', 'Tail'), ('消化内科', 'Head'), ('消化内科', 'Body'), ('消化内科', 'Other'), ('消化内科', 'Tail'), ('肛肠科', 'Body'), ('肛肠科', 'Other'), ('肛肠科', 'Tail'), ('肝病', 'Head'), ('肝病', 'Body'), ('肝病', 'Tail'), ('皮肤性病科', 'Head'), ('皮肤性病科', 'Body'), ('皮肤性病科', 'Other'), ('皮肤性病科', 'Tail'), ('皮肤科', 'Head'), ('皮肤科', 'Body'), ('皮肤科', 'Other'), ('皮肤科', 'Tail'), ('肝胆外科', 'Body'), ('肝胆外科', 'Other'), ('血液科', 'Head'), ('血液科', 'Body'), ('血液科', 'Other'), ('血液科', 'Tail'), ('遗传病科', 'Head'), ('遗传病科', 'Body'), ('遗传病科', 'Other'), ('肾内科', 'Body'), ('肾内科', 'Other'), ('肾内科', 'Tail'), ('泌尿外科', 'Body'), ('泌尿外科', 'Other'), ('泌尿外科', 'Tail'), ('泌尿内科', 'Body'), ('泌尿内科', 'Other'), ('泌尿内科', 'Tail'), ('中医科', 'Head'), ('中医科', 'Body'), ('中医科', 'Other'), ('中医科', 'Tail'), ('中医综合', 'Head'), ('中医综合', 'Body'), ('中医综合', 'Other'), ('中医综合', 'Tail'), ('烧伤科', 'Head'), ('烧伤科', 'Body'), ('烧伤科', 'Other'), ('烧伤科', 'Tail'), ('男科', 'Body'), ('男科', 'Other'), ('男科', 'Tail'), ('骨外科', 'Head'), ('骨外科', 'Body'), ('骨外科', 'Other'), ('骨外科', 'Tail'), ('神经外科', 'Head'), ('神经外科', 'Body'), ('神经外科', 'Other'), ('神经外科', 'Tail'), ('精神科', 'Head'), ('精神科', 'Body'), ('精神科', 'Other'), ('口腔科', 'Head'), ('口腔科', 'Body'), ('口腔科', 'Other'), ('口腔科', 'Tail'), ('营养科', 'Head'), ('营养科', 'Body'), ('营养科', 'Other'), ('营养科', 'Tail'), ('性病科', 'Head'), ('性病科', 'Body'), ('性病科', 'Other'), ('性病科', 'Tail'), ('心理科', 'Head'), ('心理科', 'Body'), ('心理科', 'Other'), ('生殖健康', 'Other'), ('不孕不育', 'Other'), ('整形美容科', 'Head'), ('整形美容科', 'Body'), ('整形美容科', 'Other'), ('减肥', 'Body')]
length_list = [(0.8180293501048218, 0.7893203883495146), (0.45157232704402517, 0.6159718144450969), (0.8394129979035639, 0.7067381316998469), (0.8909853249475891, 0.872486512996567), (0.7555555555555555, 0.9626213592233009), (0.3142857142857143, 0.9365825014679976), (0.9492063492063492, 0.9877488514548239), (0.9809523809523809, 0.9970573810691515), (0.8327044025157233, 0.9354368932038835), (0.5748427672955975, 0.9007633587786259), (0.7660377358490567, 0.8575803981623277), (0.8264150943396227, 0.9323197645904855), (0.8268551236749117, 0.9762135922330097), (0.5229681978798587, 0.9603640634174986), (0.7879858657243817, 0.9540581929555896), (0.8621908127208481, 0.980872976949485), (0.9170731707317074, 0.9917475728155339), (0.7219512195121951, 0.9832648267762771), (0.4097560975609756, 0.9073506891271057), (0.9512195121951219, 0.9950956351152526), (0.6956521739130435, 0.9979448032883147), (0.43478260869565216, 0.9900459418070444), (0.8695652173913043, 0.9985286905345758), (0.8571428571428571, 0.9994128009395185), (0.21428571428571427, 0.9915773353751914), (0.9285714285714286, 0.9995095635115253), (0.7729831144465291, 0.9412621359223301), (0.5928705440900562, 0.9362889019377569), (0.9174484052532833, 0.9663093415007658), (0.7166979362101313, 0.9259440902403139), (0.7681159420289855, 0.9844660194174757), (0.5144927536231884, 0.9803288314738696), (0.8695652173913043, 0.9862174578866769), (0.8478260869565217, 0.9897008337420304), (0.8349970640046976, 0.8635922330097088), (0.5913094539048738, 0.7956547269524369), (0.9624192601291838, 0.9509954058192955), (0.6106870229007634, 0.6748406081412457), (0.893048128342246, 0.9902912621359223), (0.1711229946524064, 0.9544920728126834), (0.9732620320855615, 0.9961715160796325), (0.9625668449197861, 0.9965669445806769), (0.9230769230769231, 0.9995145631067961), (0.8461538461538461, 0.9994128009395185), (0.5384615384615384, 0.9954058192955589), (0.6923076923076923, 0.998038254046101), (0.7752808988764045, 0.970873786407767), (0.7303370786516854, 0.9788608338226659), (0.8164794007490637, 0.9624808575803981), (0.6779026217228464, 0.9578224619911722), (0.8353510895883777, 0.9669902912621359), (0.5811138014527845, 0.94920728126835), (0.7046004842615012, 0.9065849923430321), (0.8789346246973365, 0.9754781755762629), (0.9680170575692963, 0.9927184466019418), (0.7292110874200426, 0.9627128596594245), (0.908315565031983, 0.9670750382848392), (0.39658848614072495, 0.8612064737616478), (0.9007633587786259, 0.9936893203883496), (0.4961832061068702, 0.9806224310041104), (0.816793893129771, 0.9816232771822359), (0.7938931297709924, 0.986758214811182), (0.916267942583732, 0.9830097087378641), (0.4880382775119617, 0.9371697005284791), (0.9617224880382775, 0.9877488514548239), (0.6339712918660287, 0.9249632172633644), (0.8414634146341463, 0.974757281553398), (0.25, 0.9277745155607751), (0.9329268292682927, 0.9831546707503829), (0.975609756097561, 0.996076508092202), (0.7766497461928934, 0.9572815533980582), (0.6192893401015228, 0.9559600704638873), (0.934010152284264, 0.9800918836140888), (0.6700507614213198, 0.9362432564982834), (0.533678756476684, 0.912621359223301), (0.6787564766839378, 0.9635936582501468), (0.8549222797927462, 0.9571209800918836), (0.9326424870466321, 0.9872486512996567), (0.9069767441860465, 0.9922330097087378), (0.37790697674418605, 0.9685848502642396), (0.7616279069767442, 0.9686064318529862), (0.9534883720930233, 0.996076508092202), (0.11899563318777293, 0.608252427184466), (0.9585152838427947, 0.9888432178508514), (0.9683406113537117, 0.9777947932618682), (0.9541484716157205, 0.9794016674840608), (0.13485477178423236, 0.7975728155339806), (0.9585062240663901, 0.994128009395185), (0.9564315352697096, 0.9839203675344563), (0.950207468879668, 0.9882295242766062), (0.6995515695067265, 0.9674757281553398), (0.515695067264574, 0.9682912507339988), (0.8609865470852018, 0.9762633996937213), (0.9237668161434978, 0.9916625796959294), (0.8383838383838383, 0.9922330097087378), (0.696969696969697, 0.9911920140927775), (0.9595959595959596, 0.996937212863706), (0.5050505050505051, 0.9759686120647376), (0.04887218045112782, 0.8771844660194175), (0.9924812030075187, 0.9994128009395185), (0.9774436090225563, 0.9954058192955589), (0.981203007518797, 0.9975478175576263), (0.9940828402366864, 0.9990291262135922), (0.8195266272189349, 0.9820904286553142), (0.9437869822485208, 0.9854517611026034), (0.24260355029585798, 0.874448258950466), (0.5, 0.998825601879037), (0.75, 0.998468606431853), (0.75, 0.9990191270230505), (0.973568281938326, 0.9941747572815534), (0.36784140969163, 0.9157369348209042), (0.9229074889867841, 0.9732006125574273), (0.73568281938326, 0.9411476213830309), (0.9841269841269841, 0.9997064004697592), (0.9841269841269841, 0.9992343032159265), (0.031746031746031744, 0.9700833742030407), (0.9873417721518988, 0.9995145631067961), (0.02531645569620253, 0.9773928361714621), (0.9873417721518988, 0.9995095635115253), (0.8509687034277198, 0.9514563106796117), (0.6304023845007451, 0.9271873165002936), (0.8226527570789866, 0.9088820826952527), (0.6944858420268256, 0.8994605198626778), (0.8513931888544891, 0.9533980582524272), (0.6253869969040248, 0.9289489136817382), (0.8173374613003096, 0.9096477794793262), (0.7043343653250774, 0.9063266307013241), (0.018867924528301886, 0.9847328244274809), (0.9811320754716981, 0.9992343032159265), (0.9151515151515152, 0.9864077669902913), (0.6484848484848484, 0.9659424544920728), (0.49393939393939396, 0.8721286370597243), (0.9424242424242424, 0.9906817067189799), (0.7777777777777778, 0.9990291262135922), (0.6666666666666666, 0.9991192014092778), (0.5555555555555556, 0.996937212863706), (0.3660130718954248, 0.9715208455666471), (0.9607843137254902, 0.9954058192955589), (0.673202614379085, 0.9754781755762629), (0.8451612903225807, 0.992953611274222), (0.967741935483871, 0.9961715160796325), (0.1870967741935484, 0.9382050024521824), (0.7272727272727273, 0.9991192014092778), (0.8181818181818182, 0.998468606431853), (0.45454545454545453, 0.9970573810691515), (0.845679012345679, 0.9635922330097088), (0.602880658436214, 0.9433352906635349), (0.7736625514403292, 0.9157733537519143), (0.7777777777777778, 0.9470328592447278), (0.845679012345679, 0.9635922330097088), (0.602880658436214, 0.9433352906635349), (0.7736625514403292, 0.9157733537519143), (0.7777777777777778, 0.9470328592447278), (0.8947368421052632, 0.9990291262135922), (0.5789473684210527, 0.997651203758074), (0.7368421052631579, 0.9961715160796325), (0.7894736842105263, 0.998038254046101), (0.9782608695652174, 0.9994128009395185), (0.9782608695652174, 0.998468606431853), (0.043478260869565216, 0.9568415890142227), (0.886326194398682, 0.9665048543689321), (0.6243822075782537, 0.9330593071051086), (0.9686985172981878, 0.9854517611026034), (0.5189456342668863, 0.8567925453653752), (0.17297297297297298, 0.9257281553398058), (0.9405405405405406, 0.9967704051673517), (0.972972972972973, 0.9961715160796325), (0.9135135135135135, 0.9921530161844041), (0.8842975206611571, 0.9932038834951457), (0.9090909090909091, 0.9967704051673517), (0.2066115702479339, 0.9264931087289433), (0.18562874251497005, 0.9339805825242719), (0.9041916167664671, 0.995302407516148), (0.9880239520958084, 0.998468606431853), (0.9221556886227545, 0.9936243256498284), (0.9583333333333334, 0.9995145631067961), (0.5, 0.9964768056371109), (0.5833333333333334, 0.9923430321592649), (0.9583333333333334, 0.9995095635115253), (0.84, 0.9980582524271845), (0.76, 0.9982384028185555), (0.96, 0.9992343032159265), (0.44, 0.9931338891613536), (0.9722222222222222, 0.9995145631067961), (0.9444444444444444, 0.9994128009395185), (0.08333333333333333, 0.9747320061255743), (0.0, 0.998468606431853), (0.0, 0.9992343032159265), (0.6666666666666666, 0.9995145631067961), (0.6666666666666666, 0.9997064004697592), (0.6666666666666666, 0.9992343032159265), (0.0, 0.9997064004697592)]

def rank():  # 相较于科室
    keshirank_list = []
    for i in length_list:
        keshiRank = i[0]
        keshirank_list.append(keshiRank)
    # print(keshirank_list)
    newkeshirankList = sorted(keshirank_list)
    newkeshirankList = newkeshirankList[-160:]  # 选择后50个
    print(newkeshirankList[-160:])  # 选择后50个
    # exit()
    # newkeshirankList[]
    # print(keshirank_list)
    for j in newkeshirankList:
        print(couple_list[keshirank_list.index(j)])
    exit()

def rankbuwe():  # 相较于部位
    buweirank_list = []
    for i in length_list:
        buweiRank = i[1]
        buweirank_list.append(buweiRank)
    # print(keshirank_list)
    newkeshirankList = sorted(buweirank_list)
    newkeshirankList = newkeshirankList[-192:]  # 选择后50个

    print(newkeshirankList[-192:])  # 选择后50个
    # exit()
    # newkeshirankList[]
    # print(keshirank_list)
    for j in newkeshirankList:
        print(couple_list[buweirank_list.index(j)])
    exit()
if __name__=='__main__':
    # re = calcInter('妇科', 'Head')  # ['产后目病', '闭经性头痛']
    # print(re)
    # re = calcInter('耳鼻喉科', 'Body')  # ['产后目病', '闭经性头痛']
    # print(re)

    re = calcInter('康复科', 'Body')  # 尿失禁
    # re = calcInter('遗传病科', 'Head')  # 心-耳综合征
    # re = calcInter('小儿内科', 'Tail')  # '小儿单纯性血尿',
    print(re)
    rank()
    cala()



    """re = calcInter('五官科', 'Head')  # '小儿单纯性血尿',
    print(re)
    rankbuwe()"""